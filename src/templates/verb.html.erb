<!DOCTYPE html>
<html lang="<%= target_lang %>">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="../../assets/css/verb.css">
</head>
<body>
    <div class="container">
        <header>
            <a href="../index.html" class="back-link"><%= labels[:back] %></a>
            <h1><%= h1 %></h1>
            <p class="subtitle"><%= subtitle %></p>
        </header>

        <div class="controls">
            <input type="text" class="search-box" placeholder="<%= labels[:search] %>" id="searchInput">
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="showAll()"><%= labels[:show_all] %></button>
            <button class="btn btn-secondary" onclick="hideAll()"><%= labels[:hide_all] %></button>
        </div>

        <div class="stats" id="stats"><%= labels[:showing] %>: <%= phrases.length %> <%= labels[:of] %> <%= phrases.length %> <%= labels[:phrases] %></div>

        <div class="phrase-list" id="phraseList">
        </div>

        <footer>
            <%= footer %> Â· <a href="https://github.com/maierru/verb-drill">GitHub</a>
        </footer>
    </div>

<% if defined?(conjugation) && conjugation -%>
    <!-- Conjugation FAB -->
    <button class="conjugation-fab" onclick="openConjugation()" title="Conjugation table">ðŸ“–</button>

    <!-- Conjugation Modal -->
    <div class="conjugation-modal" id="conjugationModal">
        <div class="conjugation-content">
            <button class="conjugation-close" onclick="closeConjugation()">&times;</button>
            <h2 class="conjugation-title"><%= h1 %></h2>
<% conjugation.each do |tense_data| -%>
            <div class="tense-explanation">
                <h4><%= tense_data['tense'] %></h4>
                <p><%= tense_data['explanation'][origin_key] %></p>
            </div>
            <table class="conjugation-table">
                <thead>
                    <tr>
                        <th>Pronoun</th>
                        <th>Form</th>
                    </tr>
                </thead>
                <tbody>
<% tense_data['forms'].each do |pronoun, form| -%>
                    <tr>
                        <td class="pronoun"><%= pronoun %></td>
                        <td><%= form %></td>
                    </tr>
<% end -%>
                </tbody>
            </table>
<% end -%>
        </div>
    </div>
<% end -%>

    <script>
        const VERB_CONFIG = {
            originKey: '<%= origin_key %>',
            targetKey: '<%= target_key %>',
            labels: { target: '<%= labels[:target] %>', showing: '<%= labels[:showing] %>', of: '<%= labels[:of] %>', phrases: '<%= labels[:phrases] %>' },
            verbForms: <%= verb_forms.to_json %>,
            phrases: [
<% phrases.each do |p| -%>
                { <%= origin_key %>: <%= p[origin_key].to_json %>, <%= target_key %>: <%= p[target_key].to_json %>, tense: <%= p['tense'].to_json %> },
<% end -%>
            ]
        };
    </script>
    <script src="../../assets/js/verb.js"></script>
</body>
</html>
